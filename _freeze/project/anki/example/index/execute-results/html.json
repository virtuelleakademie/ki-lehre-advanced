{
  "hash": "cf8d119842df88d0a5ec554afd5eb06f",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Generate Anki flashcards: example code\"\njupyter: python3\nexecute: \n  cache: true\n---\n\n\n\n\nFirst, we import the required libraries:\n\n::: {#422f260d .cell execution_count=1}\n``` {.python .cell-code}\nimport os\nimport csv\nfrom dotenv import load_dotenv  # For loading environment variables\nfrom openai import OpenAI \n\nfrom pydantic import BaseModel, Field\nfrom typing import List\n```\n:::\n\n\nInitialize the OpenAI client using environment variables:\n\n::: {#41a15266 .cell execution_count=2}\n``` {.python .cell-code}\nload_dotenv()\nclient = OpenAI()\n```\n:::\n\n\nDefine our data models using Pydantic for type safety and validation:\n\n::: {#a2b8a171 .cell execution_count=3}\n``` {.python .cell-code}\nclass AnkiFlashcard(BaseModel):\n    \"\"\"\n    Model representing a single Anki flashcard with question, answer, and tags.\n    \"\"\"\n    # Define required fields with descriptions\n    question: str = Field(..., description=\"The front side of the flashcard containing the question\")\n    answer: str = Field(..., description=\"The back side of the flashcard containing the answer\")\n    tags: List[str] = Field(..., description=\"List of tags associated with the flashcard\")\n```\n:::\n\n\nCreate a model to represent a complete deck of flashcards:\n\n::: {#f6ffa798 .cell execution_count=4}\n``` {.python .cell-code}\nclass AnkiDeck(BaseModel):\n    \"\"\"\n    Model representing a complete Anki deck containing multiple flashcards.\n    \"\"\"\n    # Define required fields with descriptions\n    cards: List[AnkiFlashcard] = Field(..., description=\"List of flashcards in the deck\")\n    deck_name: str = Field(..., description=\"Name of the Anki deck\")\n```\n:::\n\n\nDefine the main function that generates flashcards using GPT-4:\n\n::: {#4604fb83 .cell execution_count=5}\n``` {.python .cell-code}\ndef generate_structured_flashcards(text: str, \n                                   deck_name: str, \n                                   num_cards: int = 5) -> AnkiDeck:\n    \"\"\"\n    Generate structured flashcards using GPT-4o with enforced Pydantic model output.\n    \n    Args:\n        text (str): The input text to generate flashcards from\n        deck_name (str): Name for the Anki deck\n        num_cards (int): Number of flashcards to generate (default: 5)\n        \n    Returns:\n        AnkiDeck: A structured deck of flashcards with proper validation\n        \n    Raises:\n        ValueError: If num_cards is less than 1\n    \"\"\"\n    # Validate input\n    if num_cards < 1:\n        raise ValueError(\"Number of cards must be at least 1\")\n    \n    # Make API call with structured output format\n    completion = client.beta.chat.completions.parse(\n        model=\"gpt-4o\",\n        messages=[\n            {\n                \"role\": \"system\",\n                \"content\": f\"\"\"You are an expert at creating Anki flashcards. Your task is to:\n1. Read the provided text\n2. Create {num_cards} Anki flashcards that cover the main concepts\n3. Add relevant tags to each flashcard\n4. Structure the output as an Anki deck with the name \"{deck_name}\".\"\"\"\n            },\n            {\n                \"role\": \"user\",\n                \"content\": f\"Please create Anki flashcards for the following text: {text}\"\n            }\n        ],\n        response_format=AnkiDeck,\n    )\n    \n    # Return the parsed response\n    return completion.choices[0].message.parsed\n```\n:::\n\n\nLoad our sample text about the Romantic era from a markdown file:\n\n\n\nDisplay the content of the romantic text (hidden by default):\n\n:::{.callout-note collapse=true title=\"`romantic_text`\"}\n## The Romantic Era: Emotion Unleashed (1810-1910)\n\nThe Romantic era represented a dramatic shift in musical aesthetics, prioritizing emotional expression, individualism, and nationalism over the formal constraints of the Classical period. This century-long period saw an unprecedented expansion in the scope, scale, and emotional range of classical music.\n\n### The Romantic Spirit\n\nRomanticism emerged as a reaction against the rationalism of the Enlightenment and the Industrial Revolution. Composers sought to express intense personal emotions, explore supernatural themes, and celebrate national identity through music. This new aesthetic led to the development of program music - compositions that told specific stories or painted musical pictures.\n\n### Expansion of Musical Language\n\nThe Romantic period saw a significant expansion of harmonic language. Composers pushed the boundaries of chromatic harmony, using increasingly complex chord progressions and modulations to distant keys. This development reached its apex in Wagner's \"Tristan und Isolde,\" whose famous \"Tristan chord\" symbolized the dissolution of traditional tonality.\n\n### The Symphony Transformed\n\nThe symphony, inherited from the Classical era, underwent radical transformation. Beethoven's Ninth Symphony, with its unprecedented scale and inclusion of vocal soloists and chorus, set new standards for symphonic composition. Later composers like Berlioz, Mahler, and Bruckner created symphonies of enormous proportions, both in length and orchestral forces.\n\n### New Forms and Genres\n\nThe period saw the emergence of new musical forms suited to Romantic expression. The symphonic poem, developed by Franz Liszt, combined orchestral music with extra-musical narratives. The art song (Lied) reached new heights of sophistication in the hands of Schubert and Schumann, creating perfect unions of poetry and music.\n\n### Nationalism in Music\n\nNational schools of composition emerged as countries sought to express their cultural identity through music. Russian composers like Tchaikovsky and the \"Mighty Five\" incorporated folk melodies and national themes. Similar movements appeared in Bohemia (Smetana, Dvořák), Norway (Grieg), and other European nations.\n\n### The Rise of the Virtuoso\n\nThe Romantic era celebrated individual achievement, leading to the rise of the virtuoso performer. Pianists like Liszt and Chopin composed works of unprecedented technical difficulty, while violinists like Paganini pushed the boundaries of what was possible on their instrument. This emphasis on virtuosity influenced compositional style and public performance practices.\n\n### Wagner and Music Drama\n\nRichard Wagner revolutionized opera through his concept of Gesamtkunstwerk (total artwork), combining music, drama, poetry, and visual arts. His use of leitmotifs - recurring musical themes associated with characters, objects, or ideas - influenced not only opera but also symphonic composition and, later, film music.\n\n### Technical and Social Developments\n\nThe period saw significant developments in instrument construction. The modern piano reached its current form, while brass instruments benefited from the invention of valves. Orchestras grew larger, requiring the emergence of the conductor as an interpreter rather than merely a timekeeper.\n\n### The End of an Era\n\nThe Romantic period gradually gave way to various modern movements. The increasing chromatic harmony of late Romanticism led naturally to the breakdown of traditional tonality in the early 20th century. However, Romantic ideals of emotional expression and individualism continued to influence composers well into the modern era.\n\nThe Romantic era's emphasis on emotional expression, its technical innovations, and its expansion of musical possibilities created a legacy that continues to influence musicians today. The period's great works remain central to the concert repertoire, beloved for their emotional depth and expressive power.\n:::\n\n\n\nGenerate a deck of 10 flashcards about the Romantic era:\n\n::: {#e65bddf2 .cell execution_count=8}\n``` {.python .cell-code}\nromantic_deck = generate_structured_flashcards(romantic_text,\n                                              \"Romanticism\", \n                                              num_cards=10)\n```\n:::\n\n\nDisplay the complete deck object:\n\n::: {#22fb287c .cell execution_count=9}\n``` {.python .cell-code}\nromantic_deck\n```\n\n::: {.cell-output .cell-output-display execution_count=8}\n```\nAnkiDeck(cards=[AnkiFlashcard(question='What did the Romantic era prioritize over the formal constraints of the Classical period?', answer='The Romantic era prioritized emotional expression, individualism, and nationalism.', tags=['Romanticism', 'MusicHistory', 'ClassicalPeriod']), AnkiFlashcard(question='What aesthetic did the Romantic era react against?', answer='The Romantic era emerged as a reaction against the rationalism of the Enlightenment and the Industrial Revolution.', tags=['Romanticism', 'CulturalHistory']), AnkiFlashcard(question='What is program music in the context of Romanticism?', answer='Program music refers to compositions that told specific stories or painted musical pictures, developed during the Romantic era.', tags=['Romanticism', 'MusicForms']), AnkiFlashcard(question=\"Which composer's work symbolized the dissolution of traditional tonality during the Romantic period?\", answer='Wagner\\'s \"Tristan und Isolde,\" particularly the famous \"Tristan chord,\" symbolized the dissolution of traditional tonality.', tags=['Romanticism', 'Wagner', 'MusicTheory']), AnkiFlashcard(question='How did Beethoven transform the symphony during the Romantic period?', answer=\"Beethoven's Ninth Symphony set new standards for symphonic composition with its unprecedented scale and inclusion of vocal soloists and chorus.\", tags=['Romanticism', 'Beethoven', 'Symphony']), AnkiFlashcard(question='Which genre did Franz Liszt develop during the Romantic period?', answer='Franz Liszt developed the symphonic poem, combining orchestral music with extra-musical narratives.', tags=['Romanticism', 'Liszt', 'MusicForms']), AnkiFlashcard(question='How did nationalism manifest in Romantic music?', answer='Nationalism in Romantic music involved composers incorporating folk melodies and national themes to express cultural identity, as seen in the works of Tchaikovsky and the \"Mighty Five.\"', tags=['Romanticism', 'Nationalism', 'MusicHistory']), AnkiFlashcard(question='What role did virtuosos play in the Romantic era?', answer='Virtuosos, like pianists Liszt and Chopin and violinist Paganini, celebrated individual achievement and influenced compositional style and public performance practices with their technical prowess.', tags=['Romanticism', 'Virtuosity', 'Performance']), AnkiFlashcard(question=\"What was Wagner's concept of Gesamtkunstwerk?\", answer='Wagner\\'s concept of Gesamtkunstwerk was a \"total artwork\" combining music, drama, poetry, and visual arts, significantly influencing opera and symphonic composition.', tags=['Romanticism', 'Wagner', 'Opera']), AnkiFlashcard(question='What technical development in instruments occurred during the Romantic era?', answer='Instruments like the modern piano reached their current form, and brass instruments benefited from the invention of valves, leading to larger orchestras and the need for conductors.', tags=['Romanticism', 'Instrumentation', 'MusicTechnology'])], deck_name='Romanticism')\n```\n:::\n:::\n\n\nShow the deck in JSON format:\n\n::: {#e52b799f .cell execution_count=10}\n``` {.python .cell-code}\nprint(romantic_deck.model_dump_json())\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n{\"cards\":[{\"question\":\"What did the Romantic era prioritize over the formal constraints of the Classical period?\",\"answer\":\"The Romantic era prioritized emotional expression, individualism, and nationalism.\",\"tags\":[\"Romanticism\",\"MusicHistory\",\"ClassicalPeriod\"]},{\"question\":\"What aesthetic did the Romantic era react against?\",\"answer\":\"The Romantic era emerged as a reaction against the rationalism of the Enlightenment and the Industrial Revolution.\",\"tags\":[\"Romanticism\",\"CulturalHistory\"]},{\"question\":\"What is program music in the context of Romanticism?\",\"answer\":\"Program music refers to compositions that told specific stories or painted musical pictures, developed during the Romantic era.\",\"tags\":[\"Romanticism\",\"MusicForms\"]},{\"question\":\"Which composer's work symbolized the dissolution of traditional tonality during the Romantic period?\",\"answer\":\"Wagner's \\\"Tristan und Isolde,\\\" particularly the famous \\\"Tristan chord,\\\" symbolized the dissolution of traditional tonality.\",\"tags\":[\"Romanticism\",\"Wagner\",\"MusicTheory\"]},{\"question\":\"How did Beethoven transform the symphony during the Romantic period?\",\"answer\":\"Beethoven's Ninth Symphony set new standards for symphonic composition with its unprecedented scale and inclusion of vocal soloists and chorus.\",\"tags\":[\"Romanticism\",\"Beethoven\",\"Symphony\"]},{\"question\":\"Which genre did Franz Liszt develop during the Romantic period?\",\"answer\":\"Franz Liszt developed the symphonic poem, combining orchestral music with extra-musical narratives.\",\"tags\":[\"Romanticism\",\"Liszt\",\"MusicForms\"]},{\"question\":\"How did nationalism manifest in Romantic music?\",\"answer\":\"Nationalism in Romantic music involved composers incorporating folk melodies and national themes to express cultural identity, as seen in the works of Tchaikovsky and the \\\"Mighty Five.\\\"\",\"tags\":[\"Romanticism\",\"Nationalism\",\"MusicHistory\"]},{\"question\":\"What role did virtuosos play in the Romantic era?\",\"answer\":\"Virtuosos, like pianists Liszt and Chopin and violinist Paganini, celebrated individual achievement and influenced compositional style and public performance practices with their technical prowess.\",\"tags\":[\"Romanticism\",\"Virtuosity\",\"Performance\"]},{\"question\":\"What was Wagner's concept of Gesamtkunstwerk?\",\"answer\":\"Wagner's concept of Gesamtkunstwerk was a \\\"total artwork\\\" combining music, drama, poetry, and visual arts, significantly influencing opera and symphonic composition.\",\"tags\":[\"Romanticism\",\"Wagner\",\"Opera\"]},{\"question\":\"What technical development in instruments occurred during the Romantic era?\",\"answer\":\"Instruments like the modern piano reached their current form, and brass instruments benefited from the invention of valves, leading to larger orchestras and the need for conductors.\",\"tags\":[\"Romanticism\",\"Instrumentation\",\"MusicTechnology\"]}],\"deck_name\":\"Romanticism\"}\n```\n:::\n:::\n\n\nPrint each flashcard in a readable format:\n\n::: {#45e9b988 .cell execution_count=11}\n``` {.python .cell-code}\nfor card in romantic_deck.cards:\n    print(f\"Question: {card.question}\")\n    print(f\"Answer: {card.answer}\")\n    print(f\"Tags: {', '.join(card.tags)}\")\n    print(\"-\" * 20)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nQuestion: What did the Romantic era prioritize over the formal constraints of the Classical period?\nAnswer: The Romantic era prioritized emotional expression, individualism, and nationalism.\nTags: Romanticism, MusicHistory, ClassicalPeriod\n--------------------\nQuestion: What aesthetic did the Romantic era react against?\nAnswer: The Romantic era emerged as a reaction against the rationalism of the Enlightenment and the Industrial Revolution.\nTags: Romanticism, CulturalHistory\n--------------------\nQuestion: What is program music in the context of Romanticism?\nAnswer: Program music refers to compositions that told specific stories or painted musical pictures, developed during the Romantic era.\nTags: Romanticism, MusicForms\n--------------------\nQuestion: Which composer's work symbolized the dissolution of traditional tonality during the Romantic period?\nAnswer: Wagner's \"Tristan und Isolde,\" particularly the famous \"Tristan chord,\" symbolized the dissolution of traditional tonality.\nTags: Romanticism, Wagner, MusicTheory\n--------------------\nQuestion: How did Beethoven transform the symphony during the Romantic period?\nAnswer: Beethoven's Ninth Symphony set new standards for symphonic composition with its unprecedented scale and inclusion of vocal soloists and chorus.\nTags: Romanticism, Beethoven, Symphony\n--------------------\nQuestion: Which genre did Franz Liszt develop during the Romantic period?\nAnswer: Franz Liszt developed the symphonic poem, combining orchestral music with extra-musical narratives.\nTags: Romanticism, Liszt, MusicForms\n--------------------\nQuestion: How did nationalism manifest in Romantic music?\nAnswer: Nationalism in Romantic music involved composers incorporating folk melodies and national themes to express cultural identity, as seen in the works of Tchaikovsky and the \"Mighty Five.\"\nTags: Romanticism, Nationalism, MusicHistory\n--------------------\nQuestion: What role did virtuosos play in the Romantic era?\nAnswer: Virtuosos, like pianists Liszt and Chopin and violinist Paganini, celebrated individual achievement and influenced compositional style and public performance practices with their technical prowess.\nTags: Romanticism, Virtuosity, Performance\n--------------------\nQuestion: What was Wagner's concept of Gesamtkunstwerk?\nAnswer: Wagner's concept of Gesamtkunstwerk was a \"total artwork\" combining music, drama, poetry, and visual arts, significantly influencing opera and symphonic composition.\nTags: Romanticism, Wagner, Opera\n--------------------\nQuestion: What technical development in instruments occurred during the Romantic era?\nAnswer: Instruments like the modern piano reached their current form, and brass instruments benefited from the invention of valves, leading to larger orchestras and the need for conductors.\nTags: Romanticism, Instrumentation, MusicTechnology\n--------------------\n```\n:::\n:::\n\n\nExport the flashcards to a CSV file for importing into Anki:\n\n::: {#c00f2ffa .cell execution_count=12}\n``` {.python .cell-code}\nos.makedirs('assets/flashcards', exist_ok=True)\n\n# Export flashcards to CSV file\nwith open('assets/flashcards/romantic-flashcards.csv', \n          'w', \n          newline='',\n          encoding='utf-8') as csvfile:\n    writer = csv.writer(csvfile)\n    # Write header row\n    writer.writerow(['Question', 'Answer', 'Tags'])\n    # Write each flashcard as a row in the CSV\n    for card in romantic_deck.cards:\n        writer.writerow([card.question, card.answer, ', '.join(card.tags)])\n```\n:::\n\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [],
    "includes": {}
  }
}